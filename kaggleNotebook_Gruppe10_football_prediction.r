{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "8a1df6e9",
   "metadata": {
    "papermill": {
     "duration": 0.005558,
     "end_time": "2022-08-10T13:57:51.581729",
     "exception": false,
     "start_time": "2022-08-10T13:57:51.576171",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Installing neccessary packages\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "359a3e9a",
   "metadata": {
    "papermill": {
     "duration": 0.004396,
     "end_time": "2022-08-10T13:57:51.592515",
     "exception": false,
     "start_time": "2022-08-10T13:57:51.588119",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Install your packages here"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "ab2adbb5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-10T13:57:51.606151Z",
     "iopub.status.busy": "2022-08-10T13:57:51.603575Z",
     "iopub.status.idle": "2022-08-10T13:59:11.711818Z",
     "shell.execute_reply": "2022-08-10T13:59:11.709996Z"
    },
    "papermill": {
     "duration": 80.117942,
     "end_time": "2022-08-10T13:59:11.714704",
     "exception": false,
     "start_time": "2022-08-10T13:57:51.596762",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Installing package into ‘/usr/local/lib/R/site-library’\n",
      "(as ‘lib’ is unspecified)\n",
      "\n",
      "Warning message in install.packages(\"jsonlite\"):\n",
      "“installation of package ‘jsonlite’ had non-zero exit status”\n",
      "Installing package into ‘/usr/local/lib/R/site-library’\n",
      "(as ‘lib’ is unspecified)\n",
      "\n",
      "Installing package into ‘/usr/local/lib/R/site-library’\n",
      "(as ‘lib’ is unspecified)\n",
      "\n",
      "also installing the dependency ‘reprex’\n",
      "\n",
      "\n",
      "Installing package into ‘/usr/local/lib/R/site-library’\n",
      "(as ‘lib’ is unspecified)\n",
      "\n",
      "Installing package into ‘/usr/local/lib/R/site-library’\n",
      "(as ‘lib’ is unspecified)\n",
      "\n",
      "Warning message in install.packages(\"httr\"):\n",
      "“installation of package ‘httr’ had non-zero exit status”\n"
     ]
    }
   ],
   "source": [
    "install.packages('jsonlite')\n",
    "install.packages('rvest')\n",
    "install.packages('tidyverse')\n",
    "install.packages('lubridate')\n",
    "install.packages('httr')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7fbdc56e",
   "metadata": {
    "papermill": {
     "duration": 0.005187,
     "end_time": "2022-08-10T13:59:11.726488",
     "exception": false,
     "start_time": "2022-08-10T13:59:11.721301",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Load the libraries here"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "0a0ab78c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-10T13:59:11.767799Z",
     "iopub.status.busy": "2022-08-10T13:59:11.738347Z",
     "iopub.status.idle": "2022-08-10T13:59:12.532679Z",
     "shell.execute_reply": "2022-08-10T13:59:12.530475Z"
    },
    "papermill": {
     "duration": 0.803762,
     "end_time": "2022-08-10T13:59:12.535079",
     "exception": false,
     "start_time": "2022-08-10T13:59:11.731317",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "── \u001b[1mAttaching packages\u001b[22m ─────────────────────────────────────── tidyverse 1.3.2 ──\n",
      "\u001b[32m✔\u001b[39m \u001b[34mggplot2\u001b[39m 3.3.6     \u001b[32m✔\u001b[39m \u001b[34mpurrr  \u001b[39m 0.3.4\n",
      "\u001b[32m✔\u001b[39m \u001b[34mtibble \u001b[39m 3.1.7     \u001b[32m✔\u001b[39m \u001b[34mdplyr  \u001b[39m 1.0.9\n",
      "\u001b[32m✔\u001b[39m \u001b[34mtidyr  \u001b[39m 1.2.0     \u001b[32m✔\u001b[39m \u001b[34mstringr\u001b[39m 1.4.0\n",
      "\u001b[32m✔\u001b[39m \u001b[34mreadr  \u001b[39m 2.1.2     \u001b[32m✔\u001b[39m \u001b[34mforcats\u001b[39m 0.5.1\n",
      "── \u001b[1mConflicts\u001b[22m ────────────────────────────────────────── tidyverse_conflicts() ──\n",
      "\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mfilter()\u001b[39m         masks \u001b[34mstats\u001b[39m::filter()\n",
      "\u001b[31m✖\u001b[39m \u001b[34mpurrr\u001b[39m::\u001b[32mflatten()\u001b[39m        masks \u001b[34mjsonlite\u001b[39m::flatten()\n",
      "\u001b[31m✖\u001b[39m \u001b[34mreadr\u001b[39m::\u001b[32mguess_encoding()\u001b[39m masks \u001b[34mrvest\u001b[39m::guess_encoding()\n",
      "\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mlag()\u001b[39m            masks \u001b[34mstats\u001b[39m::lag()\n",
      "\n",
      "Attaching package: ‘lubridate’\n",
      "\n",
      "\n",
      "The following objects are masked from ‘package:base’:\n",
      "\n",
      "    date, intersect, setdiff, union\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "library(jsonlite)\n",
    "library(httr)\n",
    "library(rvest)\n",
    "library(tidyverse)\n",
    "library(lubridate)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a46888a8",
   "metadata": {
    "papermill": {
     "duration": 0.005188,
     "end_time": "2022-08-10T13:59:12.545657",
     "exception": false,
     "start_time": "2022-08-10T13:59:12.540469",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# trimStringArray function"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "7430f23d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-10T13:59:12.560018Z",
     "iopub.status.busy": "2022-08-10T13:59:12.557825Z",
     "iopub.status.idle": "2022-08-10T13:59:12.572587Z",
     "shell.execute_reply": "2022-08-10T13:59:12.570795Z"
    },
    "papermill": {
     "duration": 0.024867,
     "end_time": "2022-08-10T13:59:12.575602",
     "exception": false,
     "start_time": "2022-08-10T13:59:12.550735",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "trimStringArray = function(array) {\n",
    "  if (is.array(array)) {\n",
    "    for (i in 1:length(array())) {\n",
    "      array[i] = trimws(array[i])\n",
    "    }\n",
    "  } else {\n",
    "    array = trimws(array)\n",
    "  }\n",
    "  array\n",
    "}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d7bc1237",
   "metadata": {
    "papermill": {
     "duration": 0.005371,
     "end_time": "2022-08-10T13:59:12.586160",
     "exception": false,
     "start_time": "2022-08-10T13:59:12.580789",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Scrape Teilnehmer von WM"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "190285c5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-10T13:59:12.600363Z",
     "iopub.status.busy": "2022-08-10T13:59:12.598807Z",
     "iopub.status.idle": "2022-08-10T13:59:12.615250Z",
     "shell.execute_reply": "2022-08-10T13:59:12.613307Z"
    },
    "papermill": {
     "duration": 0.026761,
     "end_time": "2022-08-10T13:59:12.618184",
     "exception": false,
     "start_time": "2022-08-10T13:59:12.591423",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "scrapeColumnsWM = function(game_name) {\n",
    "\n",
    "  # base url\n",
    "\n",
    "  url = 'https://www.transfermarkt.de/weltmeisterschaft-2022/teilnehmer/pokalwettbewerb/WM22/saison_id/2021'\n",
    "\n",
    "  # read url\n",
    "\n",
    "  url %>%\n",
    "    read_html() -> html\n",
    "\n",
    "  # variables\n",
    "\n",
    "  columnValues = list() # a list containing all values\n",
    "  columnNames = NULL\n",
    "  box = NULL # searching for the table_header\n",
    "  slugs = c()\n",
    "  club_ids = c()\n",
    "\n",
    "  # Obtain the correct responsive-table by name of table_header\n",
    "\n",
    "  html %>%\n",
    "    html_elements('.box') -> boxes\n",
    "\n",
    "  # Print the table headers\n",
    "\n",
    "  boxes\n",
    "\n",
    "  # Iterate over each table header to find the match with table_header\n",
    "  # argument\n",
    "\n",
    "  for (item in boxes) {\n",
    "\n",
    "    #print(item)\n",
    "\n",
    "    item %>%\n",
    "      html_elements('.table-header') %>%\n",
    "      html_text() %>%\n",
    "      trimStringArray() -> name\n",
    "\n",
    "    if (length(name) != 0 && tolower(game_name) == tolower(name)) {\n",
    "      box = item\n",
    "      break\n",
    "    }\n",
    "  }\n",
    "\n",
    "  box\n",
    "\n",
    "  if(!is.null(box)) {\n",
    "      # Obtain the responsive_table\n",
    "\n",
    "      box %>%\n",
    "          html_elements('.responsive-table') -> responsive_table\n",
    "\n",
    "      # print the responsive-table\n",
    "\n",
    "      responsive_table\n",
    "\n",
    "      # scrape the url with the slugs and club ids of the countries\n",
    "\n",
    "      responsive_table %>%\n",
    "          html_elements('tr td:first-of-type a') %>%\n",
    "          html_attr('href') %>%\n",
    "          strsplit('/') -> raw_url_data\n",
    "\n",
    "      raw_url_data\n",
    "\n",
    "      # obtain the slug of all countries\n",
    "\n",
    "      raw_url_data[1][[1]][2]\n",
    "      raw_url_data[1][[1]][length(raw_url_data[1][[1]])]\n",
    "\n",
    "      for (i in 1:length(raw_url_data)) {\n",
    "          slugs = c(slugs, raw_url_data[i][[1]][2])\n",
    "          club_ids = c(club_ids, raw_url_data[i][[1]][length(raw_url_data[1][[1]])])\n",
    "      }\n",
    "\n",
    "      # print slugs\n",
    "\n",
    "      slugs\n",
    "\n",
    "      # print club_ids\n",
    "\n",
    "      club_ids\n",
    "\n",
    "      # obtain the columnNames\n",
    "\n",
    "      responsive_table %>%\n",
    "          html_elements('th') %>%\n",
    "          html_text -> columnNames\n",
    "\n",
    "      # print columnNames\n",
    "\n",
    "      columnNames\n",
    "\n",
    "      # add slug and club_id to columnNames\n",
    "\n",
    "      columnNames = c(columnNames, c('slug', 'club_id'))\n",
    "\n",
    "      # print columnNames again\n",
    "\n",
    "      columnNames\n",
    "\n",
    "      # obtain length of a all true columns\n",
    "\n",
    "      responsive_table %>%\n",
    "          html_elements('tbody tr:nth-of-type(1) td') %>%\n",
    "          length() -> trueColumnsLength\n",
    "\n",
    "      # print the length of all true columns\n",
    "\n",
    "      trueColumnsLength\n",
    "\n",
    "      for (i in 1:trueColumnsLength) {\n",
    "          # create css selector string\n",
    "          # td:not([class*=\"no-border-rechts\"]\n",
    "          string = paste0('tbody tr td:not([class*=\"no-border-rechts\"]):nth-of-type(', i,')')\n",
    "\n",
    "          # print the css selector string\n",
    "\n",
    "          string\n",
    "\n",
    "          # obtain all row elements of specified column\n",
    "\n",
    "          responsive_table %>%\n",
    "              html_elements(string) -> html_node\n",
    "\n",
    "          # print all row elements of specified column\n",
    "\n",
    "          html_node\n",
    "\n",
    "          # only add the values if they are valid!!!\n",
    "\n",
    "          if(length(html_node) != 0) {\n",
    "              # obtain the children (if any) from the row elements\n",
    "              # of specified column\n",
    "\n",
    "              html_node %>%\n",
    "                  html_children() -> children\n",
    "\n",
    "              # print the children\n",
    "\n",
    "              children\n",
    "\n",
    "              # check the number of children contained within\n",
    "\n",
    "              num_of_children = length(children)\n",
    "\n",
    "              # print the number of children (if any)\n",
    "\n",
    "              num_of_children\n",
    "\n",
    "              # check if a child contains any subchildren\n",
    "\n",
    "              children %>%\n",
    "                  html_children() -> subchildren\n",
    "\n",
    "              # print subchildren\n",
    "\n",
    "              subchildren\n",
    "\n",
    "              # check the number of children contained within\n",
    "\n",
    "              num_of_subchildren = length(subchildren)\n",
    "\n",
    "              # print number of subchildren\n",
    "\n",
    "              num_of_subchildren\n",
    "\n",
    "              # dynammically apply a search for the values\n",
    "              # according to the number of children\n",
    "\n",
    "              if (num_of_subchildren > 0) {\n",
    "                  responsive_table %>%\n",
    "                      html_elements(string) %>%\n",
    "                      html_elements('a > span') %>%\n",
    "                      html_text() -> values\n",
    "              } else if (num_of_children > 0) {\n",
    "                  responsive_table %>%\n",
    "                      html_elements(string) %>%\n",
    "                      html_elements('a') %>%\n",
    "                      html_attr('title') -> values\n",
    "              } else {\n",
    "                  responsive_table %>%\n",
    "                      html_elements(string) %>%\n",
    "                      html_text -> values\n",
    "              }\n",
    "\n",
    "              # wrap the obtained values within a list\n",
    "\n",
    "              list(values)\n",
    "\n",
    "              # iterate over all children by\n",
    "\n",
    "              values = trimStringArray(values)\n",
    "\n",
    "              # Add this column to the columnValues list\n",
    "\n",
    "              columnValues = append(columnValues, list(values))\n",
    "          }\n",
    "          else {\n",
    "              print(paste0(\"Column \", i, \" is not a valid value\"))\n",
    "          }\n",
    "\n",
    "      }\n",
    "\n",
    "      # add club_id and slug to values\n",
    "\n",
    "      columnValues = append(columnValues, list(slugs))\n",
    "      columnValues = append(columnValues, list(club_ids))\n",
    "\n",
    "      # print columnValues\n",
    "\n",
    "      columnValues\n",
    "\n",
    "      # return list\n",
    "      list(columnNames, columnValues)\n",
    "  } else {\n",
    "      # return NULL\n",
    "      NULL\n",
    "  }\n",
    "}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b41f1b25",
   "metadata": {
    "papermill": {
     "duration": 0.005422,
     "end_time": "2022-08-10T13:59:12.628802",
     "exception": false,
     "start_time": "2022-08-10T13:59:12.623380",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# create Dataframe from scrapeColumnsWM"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "ae0313ad",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-10T13:59:12.643513Z",
     "iopub.status.busy": "2022-08-10T13:59:12.641778Z",
     "iopub.status.idle": "2022-08-10T13:59:12.656846Z",
     "shell.execute_reply": "2022-08-10T13:59:12.654904Z"
    },
    "papermill": {
     "duration": 0.025459,
     "end_time": "2022-08-10T13:59:12.659855",
     "exception": false,
     "start_time": "2022-08-10T13:59:12.634396",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "create_dataframeWM = function(name) {\n",
    "  print(scrapeColumnsWM(name))\n",
    "  df_wm = scrapeColumnsWM(name)\n",
    "\n",
    "  if(!(is.null(df_wm))) {\n",
    "      columns = df_wm[[2]]\n",
    "      columnNames = df_wm[[1]]\n",
    "\n",
    "      #print(columnNames)\n",
    "\n",
    "      df_wm = data.frame(columns[[1]])\n",
    "\n",
    "      for (i in 2:length(columns)) {\n",
    "          df_wm[i] = columns[[i]]\n",
    "      }\n",
    "\n",
    "      names(df_wm) = columnNames[2:length(columnNames)]\n",
    "      df_wm\n",
    "  } else {\n",
    "      NULL\n",
    "  }\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "5634da9a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-10T13:59:12.673998Z",
     "iopub.status.busy": "2022-08-10T13:59:12.672348Z",
     "iopub.status.idle": "2022-08-10T13:59:17.452762Z",
     "shell.execute_reply": "2022-08-10T13:59:17.450099Z"
    },
    "papermill": {
     "duration": 4.790755,
     "end_time": "2022-08-10T13:59:17.456077",
     "exception": false,
     "start_time": "2022-08-10T13:59:12.665322",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1] \"Column 1 is not a valid value\"\n",
      "[[1]]\n",
      " [1] \"wappen\"            \"Verein\"            \"Kader\"            \n",
      " [4] \"&oslash-Alter\"     \"WM-Teilnahmen\"     \"Legionäre\"        \n",
      " [7] \"Marktwert\"         \"&oslash-Marktwert\" \"slug\"             \n",
      "[10] \"club_id\"          \n",
      "\n",
      "[[2]]\n",
      "[[2]][[1]]\n",
      " [1] \"England\"            \"Frankreich\"         \"Brasilien\"         \n",
      " [4] \"Deutschland\"        \"Portugal\"           \"Spanien\"           \n",
      " [7] \"Argentinien\"        \"Niederlande\"        \"Uruguay\"           \n",
      "[10] \"Serbien\"            \"Kroatien\"           \"Belgien\"           \n",
      "[13] \"Polen\"              \"Senegal\"            \"Dänemark\"          \n",
      "[16] \"Schweiz\"            \"Marokko\"            \"Vereinigte Staaten\"\n",
      "[19] \"Kanada\"             \"Wales\"              \"Kamerun\"           \n",
      "[22] \"Ghana\"              \"Ecuador\"            \"Mexiko\"            \n",
      "[25] \"Iran\"               \"Australien\"         \"Tunesien\"          \n",
      "[28] \"Saudi-Arabien\"      \"Japan\"              \"Südkorea\"          \n",
      "[31] \"Katar\"              \"Costa Rica\"        \n",
      "\n",
      "[[2]][[2]]\n",
      " [1] \"27\" \"25\" \"28\" \"25\" \"23\" \"24\" \"28\" \"25\" \"27\" \"29\" \"28\" \"24\" \"37\" \"26\" \"23\"\n",
      "[16] \"28\" \"31\" \"26\" \"25\" \"29\" \"25\" \"37\" \"28\" \"23\" \"30\" \"35\" \"25\" \"26\" \"26\" \"26\"\n",
      "[31] \"27\" \"23\"\n",
      "\n",
      "[[2]][[3]]\n",
      " [1] \"25,6\" \"26,9\" \"27,2\" \"26,6\" \"27,3\" \"25,9\" \"27,7\" \"26,7\" \"26,9\" \"26,1\"\n",
      "[11] \"26,4\" \"27,4\" \"26,5\" \"26,8\" \"26,5\" \"26,9\" \"26,7\" \"24,5\" \"26,8\" \"25,5\"\n",
      "[21] \"26,4\" \"25,2\" \"25,2\" \"25,8\" \"27,1\" \"27,6\" \"26,5\" \"26,7\" \"26,2\" \"26,1\"\n",
      "[31] \"26,3\" \"26,5\"\n",
      "\n",
      "[[2]][[4]]\n",
      " [1] \"16\" \"16\" \"22\" \"20\" \"8\"  \"16\" \"18\" \"11\" \"14\" \"3\"  \"6\"  \"14\" \"9\"  \"3\"  \"6\" \n",
      "[16] \"12\" \"6\"  \"11\" \"2\"  \"2\"  \"8\"  \"4\"  \"4\"  \"17\" \"6\"  \"6\"  \"6\"  \"6\"  \"7\"  \"11\"\n",
      "[31] \"1\"  \"6\" \n",
      "\n",
      "[[2]][[5]]\n",
      " [1] \"11,1 %\"  \"84,0 %\"  \"85,7 %\"  \"16,0 %\"  \"73,9 %\"  \"33,3 %\"  \"96,4 %\" \n",
      " [8] \"60,0 %\"  \"92,6 %\"  \"96,6 %\"  \"75,0 %\"  \"83,3 %\"  \"91,9 %\"  \"100,0 %\"\n",
      "[15] \"95,7 %\"  \"85,7 %\"  \"87,1 %\"  \"65,4 %\"  \"68,0 %\"  \"86,2 %\"  \"100,0 %\"\n",
      "[22] \"94,6 %\"  \"82,1 %\"  \"26,1 %\"  \"46,7 %\"  \"71,4 %\"  \"72,0 %\"  \"%\"      \n",
      "[29] \"3,8 %\"   \"7,7 %\"   \"%\"       \"26,1 %\" \n",
      "\n",
      "[[2]][[6]]\n",
      " [1] \"1,29 Mrd. €\"   \"1,06 Mrd. €\"   \"1,01 Mrd. €\"   \"824,50 Mio. €\"\n",
      " [5] \"772,00 Mio. €\" \"751,00 Mio. €\" \"627,00 Mio. €\" \"495,40 Mio. €\"\n",
      " [9] \"395,00 Mio. €\" \"374,50 Mio. €\" \"356,40 Mio. €\" \"339,00 Mio. €\"\n",
      "[13] \"304,40 Mio. €\" \"297,70 Mio. €\" \"287,40 Mio. €\" \"255,20 Mio. €\"\n",
      "[17] \"237,93 Mio. €\" \"212,65 Mio. €\" \"176,30 Mio. €\" \"139,20 Mio. €\"\n",
      "[21] \"114,30 Mio. €\" \"106,95 Mio. €\" \"102,75 Mio. €\" \"92,70 Mio. €\" \n",
      "[25] \"73,15 Mio. €\"  \"50,63 Mio. €\"  \"42,15 Mio. €\"  \"32,15 Mio. €\" \n",
      "[29] \"23,35 Mio. €\"  \"22,20 Mio. €\"  \"19,20 Mio. €\"  \"18,15 Mio. €\" \n",
      "\n",
      "[[2]][[7]]\n",
      " [1] \"47,89 Mio. €\" \"42,40 Mio. €\" \"36,23 Mio. €\" \"32,98 Mio. €\" \"33,57 Mio. €\"\n",
      " [6] \"31,29 Mio. €\" \"22,39 Mio. €\" \"19,82 Mio. €\" \"14,63 Mio. €\" \"12,91 Mio. €\"\n",
      "[11] \"12,73 Mio. €\" \"14,13 Mio. €\" \"8,23 Mio. €\"  \"11,45 Mio. €\" \"12,50 Mio. €\"\n",
      "[16] \"9,11 Mio. €\"  \"7,68 Mio. €\"  \"8,18 Mio. €\"  \"7,05 Mio. €\"  \"4,80 Mio. €\" \n",
      "[21] \"4,57 Mio. €\"  \"2,89 Mio. €\"  \"3,67 Mio. €\"  \"4,03 Mio. €\"  \"2,44 Mio. €\" \n",
      "[26] \"1,45 Mio. €\"  \"1,69 Mio. €\"  \"1,24 Mio. €\"  \"898 Tsd. €\"   \"854 Tsd. €\"  \n",
      "[31] \"711 Tsd. €\"   \"789 Tsd. €\"  \n",
      "\n",
      "[[2]][[8]]\n",
      " [1] \"england\"            \"frankreich\"         \"brasilien\"         \n",
      " [4] \"deutschland\"        \"portugal\"           \"spanien\"           \n",
      " [7] \"argentinien\"        \"niederlande\"        \"uruguay\"           \n",
      "[10] \"serbien\"            \"kroatien\"           \"belgien\"           \n",
      "[13] \"polen\"              \"senegal\"            \"danemark\"          \n",
      "[16] \"schweiz\"            \"marokko\"            \"vereinigte-staaten\"\n",
      "[19] \"kanada\"             \"wales\"              \"kamerun\"           \n",
      "[22] \"ghana\"              \"ecuador\"            \"mexiko\"            \n",
      "[25] \"iran\"               \"australien\"         \"tunesien\"          \n",
      "[28] \"saudi-arabien\"      \"japan\"              \"sudkorea\"          \n",
      "[31] \"katar\"              \"costa-rica\"        \n",
      "\n",
      "[[2]][[9]]\n",
      " [1] \"3299\"  \"3377\"  \"3439\"  \"3262\"  \"3300\"  \"3375\"  \"3437\"  \"3379\"  \"3449\" \n",
      "[10] \"3438\"  \"3556\"  \"3382\"  \"3442\"  \"3499\"  \"3436\"  \"3384\"  \"3575\"  \"3505\" \n",
      "[19] \"3510\"  \"3864\"  \"3434\"  \"3441\"  \"5750\"  \"6303\"  \"3582\"  \"3433\"  \"3670\" \n",
      "[28] \"3807\"  \"3435\"  \"3589\"  \"14162\" \"8497\" \n",
      "\n",
      "\n",
      "[1] \"Column 1 is not a valid value\"\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A data.frame: 32 × 9</caption>\n",
       "<thead>\n",
       "\t<tr><th scope=col>Verein</th><th scope=col>Kader</th><th scope=col>&amp;oslash-Alter</th><th scope=col>WM-Teilnahmen</th><th scope=col>Legionäre</th><th scope=col>Marktwert</th><th scope=col>&amp;oslash-Marktwert</th><th scope=col>slug</th><th scope=col>club_id</th></tr>\n",
       "\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><td>England           </td><td>27</td><td>25,6</td><td>16</td><td>11,1 % </td><td>1,29 Mrd. €  </td><td>47,89 Mio. €</td><td>england           </td><td>3299 </td></tr>\n",
       "\t<tr><td>Frankreich        </td><td>25</td><td>26,9</td><td>16</td><td>84,0 % </td><td>1,06 Mrd. €  </td><td>42,40 Mio. €</td><td>frankreich        </td><td>3377 </td></tr>\n",
       "\t<tr><td>Brasilien         </td><td>28</td><td>27,2</td><td>22</td><td>85,7 % </td><td>1,01 Mrd. €  </td><td>36,23 Mio. €</td><td>brasilien         </td><td>3439 </td></tr>\n",
       "\t<tr><td>Deutschland       </td><td>25</td><td>26,6</td><td>20</td><td>16,0 % </td><td>824,50 Mio. €</td><td>32,98 Mio. €</td><td>deutschland       </td><td>3262 </td></tr>\n",
       "\t<tr><td>Portugal          </td><td>23</td><td>27,3</td><td>8 </td><td>73,9 % </td><td>772,00 Mio. €</td><td>33,57 Mio. €</td><td>portugal          </td><td>3300 </td></tr>\n",
       "\t<tr><td>Spanien           </td><td>24</td><td>25,9</td><td>16</td><td>33,3 % </td><td>751,00 Mio. €</td><td>31,29 Mio. €</td><td>spanien           </td><td>3375 </td></tr>\n",
       "\t<tr><td>Argentinien       </td><td>28</td><td>27,7</td><td>18</td><td>96,4 % </td><td>627,00 Mio. €</td><td>22,39 Mio. €</td><td>argentinien       </td><td>3437 </td></tr>\n",
       "\t<tr><td>Niederlande       </td><td>25</td><td>26,7</td><td>11</td><td>60,0 % </td><td>495,40 Mio. €</td><td>19,82 Mio. €</td><td>niederlande       </td><td>3379 </td></tr>\n",
       "\t<tr><td>Uruguay           </td><td>27</td><td>26,9</td><td>14</td><td>92,6 % </td><td>395,00 Mio. €</td><td>14,63 Mio. €</td><td>uruguay           </td><td>3449 </td></tr>\n",
       "\t<tr><td>Serbien           </td><td>29</td><td>26,1</td><td>3 </td><td>96,6 % </td><td>374,50 Mio. €</td><td>12,91 Mio. €</td><td>serbien           </td><td>3438 </td></tr>\n",
       "\t<tr><td>Kroatien          </td><td>28</td><td>26,4</td><td>6 </td><td>75,0 % </td><td>356,40 Mio. €</td><td>12,73 Mio. €</td><td>kroatien          </td><td>3556 </td></tr>\n",
       "\t<tr><td>Belgien           </td><td>24</td><td>27,4</td><td>14</td><td>83,3 % </td><td>339,00 Mio. €</td><td>14,13 Mio. €</td><td>belgien           </td><td>3382 </td></tr>\n",
       "\t<tr><td>Polen             </td><td>37</td><td>26,5</td><td>9 </td><td>91,9 % </td><td>304,40 Mio. €</td><td>8,23 Mio. € </td><td>polen             </td><td>3442 </td></tr>\n",
       "\t<tr><td>Senegal           </td><td>26</td><td>26,8</td><td>3 </td><td>100,0 %</td><td>297,70 Mio. €</td><td>11,45 Mio. €</td><td>senegal           </td><td>3499 </td></tr>\n",
       "\t<tr><td>Dänemark          </td><td>23</td><td>26,5</td><td>6 </td><td>95,7 % </td><td>287,40 Mio. €</td><td>12,50 Mio. €</td><td>danemark          </td><td>3436 </td></tr>\n",
       "\t<tr><td>Schweiz           </td><td>28</td><td>26,9</td><td>12</td><td>85,7 % </td><td>255,20 Mio. €</td><td>9,11 Mio. € </td><td>schweiz           </td><td>3384 </td></tr>\n",
       "\t<tr><td>Marokko           </td><td>31</td><td>26,7</td><td>6 </td><td>87,1 % </td><td>237,93 Mio. €</td><td>7,68 Mio. € </td><td>marokko           </td><td>3575 </td></tr>\n",
       "\t<tr><td>Vereinigte Staaten</td><td>26</td><td>24,5</td><td>11</td><td>65,4 % </td><td>212,65 Mio. €</td><td>8,18 Mio. € </td><td>vereinigte-staaten</td><td>3505 </td></tr>\n",
       "\t<tr><td>Kanada            </td><td>25</td><td>26,8</td><td>2 </td><td>68,0 % </td><td>176,30 Mio. €</td><td>7,05 Mio. € </td><td>kanada            </td><td>3510 </td></tr>\n",
       "\t<tr><td>Wales             </td><td>29</td><td>25,5</td><td>2 </td><td>86,2 % </td><td>139,20 Mio. €</td><td>4,80 Mio. € </td><td>wales             </td><td>3864 </td></tr>\n",
       "\t<tr><td>Kamerun           </td><td>25</td><td>26,4</td><td>8 </td><td>100,0 %</td><td>114,30 Mio. €</td><td>4,57 Mio. € </td><td>kamerun           </td><td>3434 </td></tr>\n",
       "\t<tr><td>Ghana             </td><td>37</td><td>25,2</td><td>4 </td><td>94,6 % </td><td>106,95 Mio. €</td><td>2,89 Mio. € </td><td>ghana             </td><td>3441 </td></tr>\n",
       "\t<tr><td>Ecuador           </td><td>28</td><td>25,2</td><td>4 </td><td>82,1 % </td><td>102,75 Mio. €</td><td>3,67 Mio. € </td><td>ecuador           </td><td>5750 </td></tr>\n",
       "\t<tr><td>Mexiko            </td><td>23</td><td>25,8</td><td>17</td><td>26,1 % </td><td>92,70 Mio. € </td><td>4,03 Mio. € </td><td>mexiko            </td><td>6303 </td></tr>\n",
       "\t<tr><td>Iran              </td><td>30</td><td>27,1</td><td>6 </td><td>46,7 % </td><td>73,15 Mio. € </td><td>2,44 Mio. € </td><td>iran              </td><td>3582 </td></tr>\n",
       "\t<tr><td>Australien        </td><td>35</td><td>27,6</td><td>6 </td><td>71,4 % </td><td>50,63 Mio. € </td><td>1,45 Mio. € </td><td>australien        </td><td>3433 </td></tr>\n",
       "\t<tr><td>Tunesien          </td><td>25</td><td>26,5</td><td>6 </td><td>72,0 % </td><td>42,15 Mio. € </td><td>1,69 Mio. € </td><td>tunesien          </td><td>3670 </td></tr>\n",
       "\t<tr><td>Saudi-Arabien     </td><td>26</td><td>26,7</td><td>6 </td><td>%      </td><td>32,15 Mio. € </td><td>1,24 Mio. € </td><td>saudi-arabien     </td><td>3807 </td></tr>\n",
       "\t<tr><td>Japan             </td><td>26</td><td>26,2</td><td>7 </td><td>3,8 %  </td><td>23,35 Mio. € </td><td>898 Tsd. €  </td><td>japan             </td><td>3435 </td></tr>\n",
       "\t<tr><td>Südkorea          </td><td>26</td><td>26,1</td><td>11</td><td>7,7 %  </td><td>22,20 Mio. € </td><td>854 Tsd. €  </td><td>sudkorea          </td><td>3589 </td></tr>\n",
       "\t<tr><td>Katar             </td><td>27</td><td>26,3</td><td>1 </td><td>%      </td><td>19,20 Mio. € </td><td>711 Tsd. €  </td><td>katar             </td><td>14162</td></tr>\n",
       "\t<tr><td>Costa Rica        </td><td>23</td><td>26,5</td><td>6 </td><td>26,1 % </td><td>18,15 Mio. € </td><td>789 Tsd. €  </td><td>costa-rica        </td><td>8497 </td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A data.frame: 32 × 9\n",
       "\\begin{tabular}{lllllllll}\n",
       " Verein & Kader & \\&oslash-Alter & WM-Teilnahmen & Legionäre & Marktwert & \\&oslash-Marktwert & slug & club\\_id\\\\\n",
       " <chr> & <chr> & <chr> & <chr> & <chr> & <chr> & <chr> & <chr> & <chr>\\\\\n",
       "\\hline\n",
       "\t England            & 27 & 25,6 & 16 & 11,1 \\%  & 1,29 Mrd. €   & 47,89 Mio. € & england            & 3299 \\\\\n",
       "\t Frankreich         & 25 & 26,9 & 16 & 84,0 \\%  & 1,06 Mrd. €   & 42,40 Mio. € & frankreich         & 3377 \\\\\n",
       "\t Brasilien          & 28 & 27,2 & 22 & 85,7 \\%  & 1,01 Mrd. €   & 36,23 Mio. € & brasilien          & 3439 \\\\\n",
       "\t Deutschland        & 25 & 26,6 & 20 & 16,0 \\%  & 824,50 Mio. € & 32,98 Mio. € & deutschland        & 3262 \\\\\n",
       "\t Portugal           & 23 & 27,3 & 8  & 73,9 \\%  & 772,00 Mio. € & 33,57 Mio. € & portugal           & 3300 \\\\\n",
       "\t Spanien            & 24 & 25,9 & 16 & 33,3 \\%  & 751,00 Mio. € & 31,29 Mio. € & spanien            & 3375 \\\\\n",
       "\t Argentinien        & 28 & 27,7 & 18 & 96,4 \\%  & 627,00 Mio. € & 22,39 Mio. € & argentinien        & 3437 \\\\\n",
       "\t Niederlande        & 25 & 26,7 & 11 & 60,0 \\%  & 495,40 Mio. € & 19,82 Mio. € & niederlande        & 3379 \\\\\n",
       "\t Uruguay            & 27 & 26,9 & 14 & 92,6 \\%  & 395,00 Mio. € & 14,63 Mio. € & uruguay            & 3449 \\\\\n",
       "\t Serbien            & 29 & 26,1 & 3  & 96,6 \\%  & 374,50 Mio. € & 12,91 Mio. € & serbien            & 3438 \\\\\n",
       "\t Kroatien           & 28 & 26,4 & 6  & 75,0 \\%  & 356,40 Mio. € & 12,73 Mio. € & kroatien           & 3556 \\\\\n",
       "\t Belgien            & 24 & 27,4 & 14 & 83,3 \\%  & 339,00 Mio. € & 14,13 Mio. € & belgien            & 3382 \\\\\n",
       "\t Polen              & 37 & 26,5 & 9  & 91,9 \\%  & 304,40 Mio. € & 8,23 Mio. €  & polen              & 3442 \\\\\n",
       "\t Senegal            & 26 & 26,8 & 3  & 100,0 \\% & 297,70 Mio. € & 11,45 Mio. € & senegal            & 3499 \\\\\n",
       "\t Dänemark           & 23 & 26,5 & 6  & 95,7 \\%  & 287,40 Mio. € & 12,50 Mio. € & danemark           & 3436 \\\\\n",
       "\t Schweiz            & 28 & 26,9 & 12 & 85,7 \\%  & 255,20 Mio. € & 9,11 Mio. €  & schweiz            & 3384 \\\\\n",
       "\t Marokko            & 31 & 26,7 & 6  & 87,1 \\%  & 237,93 Mio. € & 7,68 Mio. €  & marokko            & 3575 \\\\\n",
       "\t Vereinigte Staaten & 26 & 24,5 & 11 & 65,4 \\%  & 212,65 Mio. € & 8,18 Mio. €  & vereinigte-staaten & 3505 \\\\\n",
       "\t Kanada             & 25 & 26,8 & 2  & 68,0 \\%  & 176,30 Mio. € & 7,05 Mio. €  & kanada             & 3510 \\\\\n",
       "\t Wales              & 29 & 25,5 & 2  & 86,2 \\%  & 139,20 Mio. € & 4,80 Mio. €  & wales              & 3864 \\\\\n",
       "\t Kamerun            & 25 & 26,4 & 8  & 100,0 \\% & 114,30 Mio. € & 4,57 Mio. €  & kamerun            & 3434 \\\\\n",
       "\t Ghana              & 37 & 25,2 & 4  & 94,6 \\%  & 106,95 Mio. € & 2,89 Mio. €  & ghana              & 3441 \\\\\n",
       "\t Ecuador            & 28 & 25,2 & 4  & 82,1 \\%  & 102,75 Mio. € & 3,67 Mio. €  & ecuador            & 5750 \\\\\n",
       "\t Mexiko             & 23 & 25,8 & 17 & 26,1 \\%  & 92,70 Mio. €  & 4,03 Mio. €  & mexiko             & 6303 \\\\\n",
       "\t Iran               & 30 & 27,1 & 6  & 46,7 \\%  & 73,15 Mio. €  & 2,44 Mio. €  & iran               & 3582 \\\\\n",
       "\t Australien         & 35 & 27,6 & 6  & 71,4 \\%  & 50,63 Mio. €  & 1,45 Mio. €  & australien         & 3433 \\\\\n",
       "\t Tunesien           & 25 & 26,5 & 6  & 72,0 \\%  & 42,15 Mio. €  & 1,69 Mio. €  & tunesien           & 3670 \\\\\n",
       "\t Saudi-Arabien      & 26 & 26,7 & 6  & \\%       & 32,15 Mio. €  & 1,24 Mio. €  & saudi-arabien      & 3807 \\\\\n",
       "\t Japan              & 26 & 26,2 & 7  & 3,8 \\%   & 23,35 Mio. €  & 898 Tsd. €   & japan              & 3435 \\\\\n",
       "\t Südkorea           & 26 & 26,1 & 11 & 7,7 \\%   & 22,20 Mio. €  & 854 Tsd. €   & sudkorea           & 3589 \\\\\n",
       "\t Katar              & 27 & 26,3 & 1  & \\%       & 19,20 Mio. €  & 711 Tsd. €   & katar              & 14162\\\\\n",
       "\t Costa Rica         & 23 & 26,5 & 6  & 26,1 \\%  & 18,15 Mio. €  & 789 Tsd. €   & costa-rica         & 8497 \\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A data.frame: 32 × 9\n",
       "\n",
       "| Verein &lt;chr&gt; | Kader &lt;chr&gt; | &amp;oslash-Alter &lt;chr&gt; | WM-Teilnahmen &lt;chr&gt; | Legionäre &lt;chr&gt; | Marktwert &lt;chr&gt; | &amp;oslash-Marktwert &lt;chr&gt; | slug &lt;chr&gt; | club_id &lt;chr&gt; |\n",
       "|---|---|---|---|---|---|---|---|---|\n",
       "| England            | 27 | 25,6 | 16 | 11,1 %  | 1,29 Mrd. €   | 47,89 Mio. € | england            | 3299  |\n",
       "| Frankreich         | 25 | 26,9 | 16 | 84,0 %  | 1,06 Mrd. €   | 42,40 Mio. € | frankreich         | 3377  |\n",
       "| Brasilien          | 28 | 27,2 | 22 | 85,7 %  | 1,01 Mrd. €   | 36,23 Mio. € | brasilien          | 3439  |\n",
       "| Deutschland        | 25 | 26,6 | 20 | 16,0 %  | 824,50 Mio. € | 32,98 Mio. € | deutschland        | 3262  |\n",
       "| Portugal           | 23 | 27,3 | 8  | 73,9 %  | 772,00 Mio. € | 33,57 Mio. € | portugal           | 3300  |\n",
       "| Spanien            | 24 | 25,9 | 16 | 33,3 %  | 751,00 Mio. € | 31,29 Mio. € | spanien            | 3375  |\n",
       "| Argentinien        | 28 | 27,7 | 18 | 96,4 %  | 627,00 Mio. € | 22,39 Mio. € | argentinien        | 3437  |\n",
       "| Niederlande        | 25 | 26,7 | 11 | 60,0 %  | 495,40 Mio. € | 19,82 Mio. € | niederlande        | 3379  |\n",
       "| Uruguay            | 27 | 26,9 | 14 | 92,6 %  | 395,00 Mio. € | 14,63 Mio. € | uruguay            | 3449  |\n",
       "| Serbien            | 29 | 26,1 | 3  | 96,6 %  | 374,50 Mio. € | 12,91 Mio. € | serbien            | 3438  |\n",
       "| Kroatien           | 28 | 26,4 | 6  | 75,0 %  | 356,40 Mio. € | 12,73 Mio. € | kroatien           | 3556  |\n",
       "| Belgien            | 24 | 27,4 | 14 | 83,3 %  | 339,00 Mio. € | 14,13 Mio. € | belgien            | 3382  |\n",
       "| Polen              | 37 | 26,5 | 9  | 91,9 %  | 304,40 Mio. € | 8,23 Mio. €  | polen              | 3442  |\n",
       "| Senegal            | 26 | 26,8 | 3  | 100,0 % | 297,70 Mio. € | 11,45 Mio. € | senegal            | 3499  |\n",
       "| Dänemark           | 23 | 26,5 | 6  | 95,7 %  | 287,40 Mio. € | 12,50 Mio. € | danemark           | 3436  |\n",
       "| Schweiz            | 28 | 26,9 | 12 | 85,7 %  | 255,20 Mio. € | 9,11 Mio. €  | schweiz            | 3384  |\n",
       "| Marokko            | 31 | 26,7 | 6  | 87,1 %  | 237,93 Mio. € | 7,68 Mio. €  | marokko            | 3575  |\n",
       "| Vereinigte Staaten | 26 | 24,5 | 11 | 65,4 %  | 212,65 Mio. € | 8,18 Mio. €  | vereinigte-staaten | 3505  |\n",
       "| Kanada             | 25 | 26,8 | 2  | 68,0 %  | 176,30 Mio. € | 7,05 Mio. €  | kanada             | 3510  |\n",
       "| Wales              | 29 | 25,5 | 2  | 86,2 %  | 139,20 Mio. € | 4,80 Mio. €  | wales              | 3864  |\n",
       "| Kamerun            | 25 | 26,4 | 8  | 100,0 % | 114,30 Mio. € | 4,57 Mio. €  | kamerun            | 3434  |\n",
       "| Ghana              | 37 | 25,2 | 4  | 94,6 %  | 106,95 Mio. € | 2,89 Mio. €  | ghana              | 3441  |\n",
       "| Ecuador            | 28 | 25,2 | 4  | 82,1 %  | 102,75 Mio. € | 3,67 Mio. €  | ecuador            | 5750  |\n",
       "| Mexiko             | 23 | 25,8 | 17 | 26,1 %  | 92,70 Mio. €  | 4,03 Mio. €  | mexiko             | 6303  |\n",
       "| Iran               | 30 | 27,1 | 6  | 46,7 %  | 73,15 Mio. €  | 2,44 Mio. €  | iran               | 3582  |\n",
       "| Australien         | 35 | 27,6 | 6  | 71,4 %  | 50,63 Mio. €  | 1,45 Mio. €  | australien         | 3433  |\n",
       "| Tunesien           | 25 | 26,5 | 6  | 72,0 %  | 42,15 Mio. €  | 1,69 Mio. €  | tunesien           | 3670  |\n",
       "| Saudi-Arabien      | 26 | 26,7 | 6  | %       | 32,15 Mio. €  | 1,24 Mio. €  | saudi-arabien      | 3807  |\n",
       "| Japan              | 26 | 26,2 | 7  | 3,8 %   | 23,35 Mio. €  | 898 Tsd. €   | japan              | 3435  |\n",
       "| Südkorea           | 26 | 26,1 | 11 | 7,7 %   | 22,20 Mio. €  | 854 Tsd. €   | sudkorea           | 3589  |\n",
       "| Katar              | 27 | 26,3 | 1  | %       | 19,20 Mio. €  | 711 Tsd. €   | katar              | 14162 |\n",
       "| Costa Rica         | 23 | 26,5 | 6  | 26,1 %  | 18,15 Mio. €  | 789 Tsd. €   | costa-rica         | 8497  |\n",
       "\n"
      ],
      "text/plain": [
       "   Verein             Kader &oslash-Alter WM-Teilnahmen Legionäre Marktwert    \n",
       "1  England            27    25,6          16            11,1 %    1,29 Mrd. €  \n",
       "2  Frankreich         25    26,9          16            84,0 %    1,06 Mrd. €  \n",
       "3  Brasilien          28    27,2          22            85,7 %    1,01 Mrd. €  \n",
       "4  Deutschland        25    26,6          20            16,0 %    824,50 Mio. €\n",
       "5  Portugal           23    27,3          8             73,9 %    772,00 Mio. €\n",
       "6  Spanien            24    25,9          16            33,3 %    751,00 Mio. €\n",
       "7  Argentinien        28    27,7          18            96,4 %    627,00 Mio. €\n",
       "8  Niederlande        25    26,7          11            60,0 %    495,40 Mio. €\n",
       "9  Uruguay            27    26,9          14            92,6 %    395,00 Mio. €\n",
       "10 Serbien            29    26,1          3             96,6 %    374,50 Mio. €\n",
       "11 Kroatien           28    26,4          6             75,0 %    356,40 Mio. €\n",
       "12 Belgien            24    27,4          14            83,3 %    339,00 Mio. €\n",
       "13 Polen              37    26,5          9             91,9 %    304,40 Mio. €\n",
       "14 Senegal            26    26,8          3             100,0 %   297,70 Mio. €\n",
       "15 Dänemark           23    26,5          6             95,7 %    287,40 Mio. €\n",
       "16 Schweiz            28    26,9          12            85,7 %    255,20 Mio. €\n",
       "17 Marokko            31    26,7          6             87,1 %    237,93 Mio. €\n",
       "18 Vereinigte Staaten 26    24,5          11            65,4 %    212,65 Mio. €\n",
       "19 Kanada             25    26,8          2             68,0 %    176,30 Mio. €\n",
       "20 Wales              29    25,5          2             86,2 %    139,20 Mio. €\n",
       "21 Kamerun            25    26,4          8             100,0 %   114,30 Mio. €\n",
       "22 Ghana              37    25,2          4             94,6 %    106,95 Mio. €\n",
       "23 Ecuador            28    25,2          4             82,1 %    102,75 Mio. €\n",
       "24 Mexiko             23    25,8          17            26,1 %    92,70 Mio. € \n",
       "25 Iran               30    27,1          6             46,7 %    73,15 Mio. € \n",
       "26 Australien         35    27,6          6             71,4 %    50,63 Mio. € \n",
       "27 Tunesien           25    26,5          6             72,0 %    42,15 Mio. € \n",
       "28 Saudi-Arabien      26    26,7          6             %         32,15 Mio. € \n",
       "29 Japan              26    26,2          7             3,8 %     23,35 Mio. € \n",
       "30 Südkorea           26    26,1          11            7,7 %     22,20 Mio. € \n",
       "31 Katar              27    26,3          1             %         19,20 Mio. € \n",
       "32 Costa Rica         23    26,5          6             26,1 %    18,15 Mio. € \n",
       "   &oslash-Marktwert slug               club_id\n",
       "1  47,89 Mio. €      england            3299   \n",
       "2  42,40 Mio. €      frankreich         3377   \n",
       "3  36,23 Mio. €      brasilien          3439   \n",
       "4  32,98 Mio. €      deutschland        3262   \n",
       "5  33,57 Mio. €      portugal           3300   \n",
       "6  31,29 Mio. €      spanien            3375   \n",
       "7  22,39 Mio. €      argentinien        3437   \n",
       "8  19,82 Mio. €      niederlande        3379   \n",
       "9  14,63 Mio. €      uruguay            3449   \n",
       "10 12,91 Mio. €      serbien            3438   \n",
       "11 12,73 Mio. €      kroatien           3556   \n",
       "12 14,13 Mio. €      belgien            3382   \n",
       "13 8,23 Mio. €       polen              3442   \n",
       "14 11,45 Mio. €      senegal            3499   \n",
       "15 12,50 Mio. €      danemark           3436   \n",
       "16 9,11 Mio. €       schweiz            3384   \n",
       "17 7,68 Mio. €       marokko            3575   \n",
       "18 8,18 Mio. €       vereinigte-staaten 3505   \n",
       "19 7,05 Mio. €       kanada             3510   \n",
       "20 4,80 Mio. €       wales              3864   \n",
       "21 4,57 Mio. €       kamerun            3434   \n",
       "22 2,89 Mio. €       ghana              3441   \n",
       "23 3,67 Mio. €       ecuador            5750   \n",
       "24 4,03 Mio. €       mexiko             6303   \n",
       "25 2,44 Mio. €       iran               3582   \n",
       "26 1,45 Mio. €       australien         3433   \n",
       "27 1,69 Mio. €       tunesien           3670   \n",
       "28 1,24 Mio. €       saudi-arabien      3807   \n",
       "29 898 Tsd. €        japan              3435   \n",
       "30 854 Tsd. €        sudkorea           3589   \n",
       "31 711 Tsd. €        katar              14162  \n",
       "32 789 Tsd. €        costa-rica         8497   "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_wm = create_dataframeWM('teilnehmende teams an der wm22')\n",
    "df_wm"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "61aa7aa1",
   "metadata": {
    "papermill": {
     "duration": 0.015062,
     "end_time": "2022-08-10T13:59:17.477419",
     "exception": false,
     "start_time": "2022-08-10T13:59:17.462357",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Scrape Columns\n",
    "We wrote a function, that takes a url to scrape all tables"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "6f0ebc4d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-10T13:59:17.493151Z",
     "iopub.status.busy": "2022-08-10T13:59:17.491706Z",
     "iopub.status.idle": "2022-08-10T13:59:17.506660Z",
     "shell.execute_reply": "2022-08-10T13:59:17.504920Z"
    },
    "papermill": {
     "duration": 0.025414,
     "end_time": "2022-08-10T13:59:17.508927",
     "exception": false,
     "start_time": "2022-08-10T13:59:17.483513",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "scrapeColumns = function(year, country, club_id, game_name) {\n",
    "\n",
    "  # base url\n",
    "\n",
    "  url = paste0(\"https://www.transfermarkt.com/\",\n",
    "               country,\n",
    "               \"/spielplan/verein/\",\n",
    "               club_id,\n",
    "               \"/plus/1?saison_id=\", year)\n",
    "\n",
    "  # read url\n",
    "\n",
    "  url %>%\n",
    "    read_html() -> html\n",
    "\n",
    "  # variables\n",
    "\n",
    "  columnValues = list() # a list containing all values\n",
    "  columnNames = NULL\n",
    "  box = NULL # searching for the table_header\n",
    "\n",
    "  # Obtain the correct responsive-table by name of table_header\n",
    "\n",
    "  html %>%\n",
    "    html_elements('.box') -> boxes\n",
    "\n",
    "  # Print the table headers\n",
    "\n",
    "  boxes\n",
    "\n",
    "  # Iterate over each table header to find the match with table_header\n",
    "  # argument\n",
    "\n",
    "  for (item in boxes) {\n",
    "\n",
    "    #print(item)\n",
    "\n",
    "    if(length(html_elements(item, '.table-header') %>% html_children())!= 0) {\n",
    "      item %>%\n",
    "        html_elements('.table-header a img') %>%\n",
    "        html_attr('title') -> name\n",
    "\n",
    "      print(name)\n",
    "    } else {\n",
    "      item %>%\n",
    "        html_elements('.table-header') %>%\n",
    "        html_text() %>%\n",
    "        trimStringArray() -> name\n",
    "\n",
    "        #print(name)\n",
    "    }\n",
    "\n",
    "    if (length(name) != 0 && tolower(game_name) == tolower(name)) {\n",
    "      box = item\n",
    "      break\n",
    "    }\n",
    "  }\n",
    "\n",
    "  box\n",
    "\n",
    "  if(!is.null(box)) {\n",
    "      # Obtain the responsive_table\n",
    "\n",
    "      box %>%\n",
    "          html_elements('.responsive-table') -> responsive_table\n",
    "\n",
    "      # print the responsive-table\n",
    "\n",
    "      responsive_table\n",
    "\n",
    "      # obtain the columnNames\n",
    "\n",
    "      responsive_table %>%\n",
    "          html_elements('th') %>%\n",
    "          html_text -> columnNames\n",
    "\n",
    "      # print columnNames\n",
    "\n",
    "      columnNames\n",
    "\n",
    "      # obtain length of a all true columns\n",
    "\n",
    "      responsive_table %>%\n",
    "          html_elements('tbody tr:nth-of-type(1) td') %>%\n",
    "          length() -> trueColumnsLength\n",
    "\n",
    "      # print the length of all true columns\n",
    "\n",
    "      trueColumnsLength\n",
    "\n",
    "      for (i in 1:trueColumnsLength) {\n",
    "          # create css selector string\n",
    "          # td:not([class*=\"no-border-rechts\"]\n",
    "          string = paste0('tbody tr td:not([class*=\"no-border-rechts\"]):nth-of-type(', i,')')\n",
    "\n",
    "          # print the css selector string\n",
    "\n",
    "          string\n",
    "\n",
    "          # obtain all row elements of specified column\n",
    "\n",
    "          responsive_table %>%\n",
    "              html_elements(string) -> html_node\n",
    "\n",
    "          # print all row elements of specified column\n",
    "\n",
    "          html_node\n",
    "\n",
    "          # only add the values if they are valid!!!\n",
    "\n",
    "          if(length(html_node) != 0) {\n",
    "              # obtain the children (if any) from the row elements\n",
    "              # of specified column\n",
    "\n",
    "              html_node %>%\n",
    "                  html_children() -> children\n",
    "\n",
    "              # print the children\n",
    "\n",
    "              children\n",
    "\n",
    "              # check the number of children contained within\n",
    "\n",
    "              num_of_children = length(children)\n",
    "\n",
    "              # print the number of children (if any)\n",
    "\n",
    "              num_of_children\n",
    "\n",
    "              # check if a child contains any subchildren\n",
    "\n",
    "              children %>%\n",
    "                  html_children() -> subchildren\n",
    "\n",
    "              # print subchildren\n",
    "\n",
    "              subchildren\n",
    "\n",
    "              # check the number of children contained within\n",
    "\n",
    "              num_of_subchildren = length(subchildren)\n",
    "\n",
    "              # print number of subchildren\n",
    "\n",
    "              num_of_subchildren\n",
    "\n",
    "              # dynammically apply a search for the values\n",
    "              # according to the number of children\n",
    "\n",
    "              if (num_of_subchildren > 0) {\n",
    "                  responsive_table %>%\n",
    "                      html_elements(string) %>%\n",
    "                      html_elements('a > span') %>%\n",
    "                      html_text() -> values\n",
    "              } else if (num_of_children > 0) {\n",
    "                  responsive_table %>%\n",
    "                      html_elements(string) %>%\n",
    "                      html_elements('a') %>%\n",
    "                      html_attr('title') -> values\n",
    "              } else {\n",
    "                  responsive_table %>%\n",
    "                      html_elements(string) %>%\n",
    "                      html_text -> values\n",
    "              }\n",
    "\n",
    "              # wrap the obtained values within a list\n",
    "\n",
    "              list(values)\n",
    "\n",
    "              # iterate over all children by\n",
    "\n",
    "              values = trimStringArray(values)\n",
    "\n",
    "              # Add this column to the columnValues list\n",
    "\n",
    "              columnValues = append(columnValues, list(values))\n",
    "          }\n",
    "          else {\n",
    "              print(paste0(\"Column \", i, \" is not a valid value\"))\n",
    "          }\n",
    "\n",
    "      }\n",
    "\n",
    "      # return list\n",
    "      list(columnNames, columnValues)\n",
    "  } else {\n",
    "      NULL\n",
    "  }\n",
    "}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "972b7ed8",
   "metadata": {
    "papermill": {
     "duration": 0.006393,
     "end_time": "2022-08-10T13:59:17.521578",
     "exception": false,
     "start_time": "2022-08-10T13:59:17.515185",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Create Dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "817cb8ed",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-10T13:59:17.537719Z",
     "iopub.status.busy": "2022-08-10T13:59:17.536097Z",
     "iopub.status.idle": "2022-08-10T13:59:17.549291Z",
     "shell.execute_reply": "2022-08-10T13:59:17.547577Z"
    },
    "papermill": {
     "duration": 0.023667,
     "end_time": "2022-08-10T13:59:17.551610",
     "exception": false,
     "start_time": "2022-08-10T13:59:17.527943",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "createDataframe = function(year, country, club_id, game_name) {\n",
    "\n",
    "  list = scrapeColumns(year, country, club_id, game_name)\n",
    "\n",
    "  if(!is.null(list)) {\n",
    "      print(\"test\")\n",
    "      print(list)\n",
    "      columns = list[[2]]\n",
    "      columnNames = list[[1]]\n",
    "\n",
    "      #print(columns)\n",
    "      #print(columnNames)\n",
    "\n",
    "      # create a dataframe with first colum and append the rest (workaround)\n",
    "      df_test = data.frame(columns[[1]])\n",
    "\n",
    "      for (i in 2:length(columns)) {\n",
    "          df_test[i] = columns[[i]]\n",
    "      }\n",
    "\n",
    "      names(df_test) = columnNames\n",
    "      df_test\n",
    "  } else {\n",
    "      NULL\n",
    "  }\n",
    "}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "65d6bf4e",
   "metadata": {
    "papermill": {
     "duration": 0.00695,
     "end_time": "2022-08-10T13:59:17.565203",
     "exception": false,
     "start_time": "2022-08-10T13:59:17.558253",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Testing Section"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "52fdf60d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-10T13:59:17.581198Z",
     "iopub.status.busy": "2022-08-10T13:59:17.579544Z",
     "iopub.status.idle": "2022-08-10T13:59:23.099575Z",
     "shell.execute_reply": "2022-08-10T13:59:23.097345Z"
    },
    "papermill": {
     "duration": 5.531346,
     "end_time": "2022-08-10T13:59:23.102800",
     "exception": false,
     "start_time": "2022-08-10T13:59:17.571454",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "character(0)\n",
      "[1] \"European Qualifiers\"\n",
      "[1] \"International Friendlies\"\n",
      "[1] \"Column 3 is not a valid value\"\n",
      "[1] \"Column 5 is not a valid value\"\n",
      "[1] \"test\"\n",
      "[[1]]\n",
      "[1] \"Date\"           \"Time\"           \"Home team\"      \"Away team\"     \n",
      "[5] \"System of play\" \"Coach\"          \"Attendance\"     \"Result\"        \n",
      "\n",
      "[[2]]\n",
      "[[2]][[1]]\n",
      "[1] \"Wed Mar 3, 2010\"  \"Mon May 24, 2010\" \"Sun May 30, 2010\" \"Wed Aug 11, 2010\"\n",
      "[5] \"Wed Nov 17, 2010\"\n",
      "\n",
      "[[2]][[2]]\n",
      "[1] \"9:00 PM\" \"9:00 PM\" \"2:15 PM\" \"9:00 PM\" \"9:00 PM\"\n",
      "\n",
      "[[2]][[3]]\n",
      "[1] \"England\" \"England\" \"England\" \"England\" \"England\"\n",
      "\n",
      "[[2]][[4]]\n",
      "[1] \"Egypt\"   \"Mexico\"  \"Japan\"   \"Hungary\" \"France\" \n",
      "\n",
      "[[2]][[5]]\n",
      "[1] \"4-4-2 double 6\" \"4-2-3-1\"        \"4-4-2 double 6\" \"4-2-3-1\"       \n",
      "[5] \"4-2-3-1\"       \n",
      "\n",
      "[[2]][[6]]\n",
      "[1] \"Fabio Capello\" \"Fabio Capello\" \"Fabio Capello\" \"Fabio Capello\"\n",
      "[5] \"Fabio Capello\"\n",
      "\n",
      "[[2]][[7]]\n",
      "[1] \"80.602\" \"88.638\" \"15.326\" \"72.024\" \"85.495\"\n",
      "\n",
      "[[2]][[8]]\n",
      "[1] \"3:1\" \"3:1\" \"2:1\" \"2:1\" \"1:2\"\n",
      "\n",
      "\n",
      "character(0)\n",
      "[1] \"European Qualifiers\"\n",
      "[1] \"International Friendlies\"\n",
      "[1] \"Column 3 is not a valid value\"\n",
      "[1] \"Column 5 is not a valid value\"\n",
      "[1] \"test\"\n",
      "[[1]]\n",
      "[1] \"Date\"           \"Time\"           \"Home team\"      \"Away team\"     \n",
      "[5] \"System of play\" \"Coach\"          \"Attendance\"     \"Result\"        \n",
      "\n",
      "[[2]]\n",
      "[[2]][[1]]\n",
      "[1] \"Wed Feb 9, 2011\"  \"Tue Mar 29, 2011\" \"Sat Nov 12, 2011\" \"Tue Nov 15, 2011\"\n",
      "\n",
      "[[2]][[2]]\n",
      "[1] \"8:15 PM\" \"9:00 PM\" \"6:15 PM\" \"9:00 PM\"\n",
      "\n",
      "[[2]][[3]]\n",
      "[1] \"Denmark\" \"England\" \"England\" \"England\"\n",
      "\n",
      "[[2]][[4]]\n",
      "[1] \"England\" \"Ghana\"   \"Spain\"   \"Sweden\" \n",
      "\n",
      "[[2]][[5]]\n",
      "[1] \"4-2-3-1\"         \"4-1-4-1\"         \"4-3-3 Attacking\" \"4-5-1 flat\"     \n",
      "\n",
      "[[2]][[6]]\n",
      "[1] \"Fabio Capello\" \"Fabio Capello\" \"Fabio Capello\" \"Fabio Capello\"\n",
      "\n",
      "[[2]][[7]]\n",
      "[1] \"21.523\" \"80.102\" \"87.189\" \"48.876\"\n",
      "\n",
      "[[2]][[8]]\n",
      "[1] \"1:2\" \"1:1\" \"1:0\" \"1:0\"\n",
      "\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A data.frame: 9 × 8</caption>\n",
       "<thead>\n",
       "\t<tr><th scope=col>Date</th><th scope=col>Time</th><th scope=col>Home team</th><th scope=col>Away team</th><th scope=col>System of play</th><th scope=col>Coach</th><th scope=col>Attendance</th><th scope=col>Result</th></tr>\n",
       "\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><td>Wed Mar 3, 2010 </td><td>9:00 PM</td><td>England</td><td>Egypt  </td><td>4-4-2 double 6 </td><td>Fabio Capello</td><td>80.602</td><td>3:1</td></tr>\n",
       "\t<tr><td>Mon May 24, 2010</td><td>9:00 PM</td><td>England</td><td>Mexico </td><td>4-2-3-1        </td><td>Fabio Capello</td><td>88.638</td><td>3:1</td></tr>\n",
       "\t<tr><td>Sun May 30, 2010</td><td>2:15 PM</td><td>England</td><td>Japan  </td><td>4-4-2 double 6 </td><td>Fabio Capello</td><td>15.326</td><td>2:1</td></tr>\n",
       "\t<tr><td>Wed Aug 11, 2010</td><td>9:00 PM</td><td>England</td><td>Hungary</td><td>4-2-3-1        </td><td>Fabio Capello</td><td>72.024</td><td>2:1</td></tr>\n",
       "\t<tr><td>Wed Nov 17, 2010</td><td>9:00 PM</td><td>England</td><td>France </td><td>4-2-3-1        </td><td>Fabio Capello</td><td>85.495</td><td>1:2</td></tr>\n",
       "\t<tr><td>Wed Feb 9, 2011 </td><td>8:15 PM</td><td>Denmark</td><td>England</td><td>4-2-3-1        </td><td>Fabio Capello</td><td>21.523</td><td>1:2</td></tr>\n",
       "\t<tr><td>Tue Mar 29, 2011</td><td>9:00 PM</td><td>England</td><td>Ghana  </td><td>4-1-4-1        </td><td>Fabio Capello</td><td>80.102</td><td>1:1</td></tr>\n",
       "\t<tr><td>Sat Nov 12, 2011</td><td>6:15 PM</td><td>England</td><td>Spain  </td><td>4-3-3 Attacking</td><td>Fabio Capello</td><td>87.189</td><td>1:0</td></tr>\n",
       "\t<tr><td>Tue Nov 15, 2011</td><td>9:00 PM</td><td>England</td><td>Sweden </td><td>4-5-1 flat     </td><td>Fabio Capello</td><td>48.876</td><td>1:0</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A data.frame: 9 × 8\n",
       "\\begin{tabular}{llllllll}\n",
       " Date & Time & Home team & Away team & System of play & Coach & Attendance & Result\\\\\n",
       " <chr> & <chr> & <chr> & <chr> & <chr> & <chr> & <chr> & <chr>\\\\\n",
       "\\hline\n",
       "\t Wed Mar 3, 2010  & 9:00 PM & England & Egypt   & 4-4-2 double 6  & Fabio Capello & 80.602 & 3:1\\\\\n",
       "\t Mon May 24, 2010 & 9:00 PM & England & Mexico  & 4-2-3-1         & Fabio Capello & 88.638 & 3:1\\\\\n",
       "\t Sun May 30, 2010 & 2:15 PM & England & Japan   & 4-4-2 double 6  & Fabio Capello & 15.326 & 2:1\\\\\n",
       "\t Wed Aug 11, 2010 & 9:00 PM & England & Hungary & 4-2-3-1         & Fabio Capello & 72.024 & 2:1\\\\\n",
       "\t Wed Nov 17, 2010 & 9:00 PM & England & France  & 4-2-3-1         & Fabio Capello & 85.495 & 1:2\\\\\n",
       "\t Wed Feb 9, 2011  & 8:15 PM & Denmark & England & 4-2-3-1         & Fabio Capello & 21.523 & 1:2\\\\\n",
       "\t Tue Mar 29, 2011 & 9:00 PM & England & Ghana   & 4-1-4-1         & Fabio Capello & 80.102 & 1:1\\\\\n",
       "\t Sat Nov 12, 2011 & 6:15 PM & England & Spain   & 4-3-3 Attacking & Fabio Capello & 87.189 & 1:0\\\\\n",
       "\t Tue Nov 15, 2011 & 9:00 PM & England & Sweden  & 4-5-1 flat      & Fabio Capello & 48.876 & 1:0\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A data.frame: 9 × 8\n",
       "\n",
       "| Date &lt;chr&gt; | Time &lt;chr&gt; | Home team &lt;chr&gt; | Away team &lt;chr&gt; | System of play &lt;chr&gt; | Coach &lt;chr&gt; | Attendance &lt;chr&gt; | Result &lt;chr&gt; |\n",
       "|---|---|---|---|---|---|---|---|\n",
       "| Wed Mar 3, 2010  | 9:00 PM | England | Egypt   | 4-4-2 double 6  | Fabio Capello | 80.602 | 3:1 |\n",
       "| Mon May 24, 2010 | 9:00 PM | England | Mexico  | 4-2-3-1         | Fabio Capello | 88.638 | 3:1 |\n",
       "| Sun May 30, 2010 | 2:15 PM | England | Japan   | 4-4-2 double 6  | Fabio Capello | 15.326 | 2:1 |\n",
       "| Wed Aug 11, 2010 | 9:00 PM | England | Hungary | 4-2-3-1         | Fabio Capello | 72.024 | 2:1 |\n",
       "| Wed Nov 17, 2010 | 9:00 PM | England | France  | 4-2-3-1         | Fabio Capello | 85.495 | 1:2 |\n",
       "| Wed Feb 9, 2011  | 8:15 PM | Denmark | England | 4-2-3-1         | Fabio Capello | 21.523 | 1:2 |\n",
       "| Tue Mar 29, 2011 | 9:00 PM | England | Ghana   | 4-1-4-1         | Fabio Capello | 80.102 | 1:1 |\n",
       "| Sat Nov 12, 2011 | 6:15 PM | England | Spain   | 4-3-3 Attacking | Fabio Capello | 87.189 | 1:0 |\n",
       "| Tue Nov 15, 2011 | 9:00 PM | England | Sweden  | 4-5-1 flat      | Fabio Capello | 48.876 | 1:0 |\n",
       "\n"
      ],
      "text/plain": [
       "  Date             Time    Home team Away team System of play  Coach        \n",
       "1 Wed Mar 3, 2010  9:00 PM England   Egypt     4-4-2 double 6  Fabio Capello\n",
       "2 Mon May 24, 2010 9:00 PM England   Mexico    4-2-3-1         Fabio Capello\n",
       "3 Sun May 30, 2010 2:15 PM England   Japan     4-4-2 double 6  Fabio Capello\n",
       "4 Wed Aug 11, 2010 9:00 PM England   Hungary   4-2-3-1         Fabio Capello\n",
       "5 Wed Nov 17, 2010 9:00 PM England   France    4-2-3-1         Fabio Capello\n",
       "6 Wed Feb 9, 2011  8:15 PM Denmark   England   4-2-3-1         Fabio Capello\n",
       "7 Tue Mar 29, 2011 9:00 PM England   Ghana     4-1-4-1         Fabio Capello\n",
       "8 Sat Nov 12, 2011 6:15 PM England   Spain     4-3-3 Attacking Fabio Capello\n",
       "9 Tue Nov 15, 2011 9:00 PM England   Sweden    4-5-1 flat      Fabio Capello\n",
       "  Attendance Result\n",
       "1 80.602     3:1   \n",
       "2 88.638     3:1   \n",
       "3 15.326     2:1   \n",
       "4 72.024     2:1   \n",
       "5 85.495     1:2   \n",
       "6 21.523     1:2   \n",
       "7 80.102     1:1   \n",
       "8 87.189     1:0   \n",
       "9 48.876     1:0   "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Scraping the international friendlies\n",
    "df_football = NULL\n",
    "\n",
    "for (i in 2009:2010) {\n",
    "    if (!is.data.frame(df_football)) {\n",
    "        df_football = createDataframe(i, 'england', 3299, 'international friendlies')\n",
    "    } else {\n",
    "        df_football_test = createDataframe(i, 'england', 3299, 'international friendlies')\n",
    "        df_football = rbind(df_football, df_football_test)\n",
    "    }\n",
    "}\n",
    "df_football"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "074c342b",
   "metadata": {
    "papermill": {
     "duration": 0.007069,
     "end_time": "2022-08-10T13:59:23.116795",
     "exception": false,
     "start_time": "2022-08-10T13:59:23.109726",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Split Result in Goals"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "9f33c62d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-10T13:59:23.133192Z",
     "iopub.status.busy": "2022-08-10T13:59:23.131469Z",
     "iopub.status.idle": "2022-08-10T13:59:23.225430Z",
     "shell.execute_reply": "2022-08-10T13:59:23.223656Z"
    },
    "papermill": {
     "duration": 0.105011,
     "end_time": "2022-08-10T13:59:23.228254",
     "exception": false,
     "start_time": "2022-08-10T13:59:23.123243",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>\n",
       ".list-inline {list-style: none; margin:0; padding: 0}\n",
       ".list-inline>li {display: inline-block}\n",
       ".list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n",
       "</style>\n",
       "<ol class=list-inline><li>'3'</li><li>'3'</li><li>'2'</li><li>'2'</li><li>'1'</li><li>'1'</li><li>'1'</li><li>'1'</li><li>'1'</li></ol>\n"
      ],
      "text/latex": [
       "\\begin{enumerate*}\n",
       "\\item '3'\n",
       "\\item '3'\n",
       "\\item '2'\n",
       "\\item '2'\n",
       "\\item '1'\n",
       "\\item '1'\n",
       "\\item '1'\n",
       "\\item '1'\n",
       "\\item '1'\n",
       "\\end{enumerate*}\n"
      ],
      "text/markdown": [
       "1. '3'\n",
       "2. '3'\n",
       "3. '2'\n",
       "4. '2'\n",
       "5. '1'\n",
       "6. '1'\n",
       "7. '1'\n",
       "8. '1'\n",
       "9. '1'\n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "[1] \"3\" \"3\" \"2\" \"2\" \"1\" \"1\" \"1\" \"1\" \"1\""
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A data.frame: 9 × 10</caption>\n",
       "<thead>\n",
       "\t<tr><th scope=col>Date</th><th scope=col>Time</th><th scope=col>Home team</th><th scope=col>Away team</th><th scope=col>System of play</th><th scope=col>Coach</th><th scope=col>Attendance</th><th scope=col>Result</th><th scope=col>goals_scored_links</th><th scope=col>goals_scored_rechts</th></tr>\n",
       "\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><td>Wed Mar 3, 2010 </td><td>9:00 PM</td><td>England</td><td>Egypt  </td><td>4-4-2 double 6 </td><td>Fabio Capello</td><td>80.602</td><td>3:1</td><td>3</td><td>1</td></tr>\n",
       "\t<tr><td>Mon May 24, 2010</td><td>9:00 PM</td><td>England</td><td>Mexico </td><td>4-2-3-1        </td><td>Fabio Capello</td><td>88.638</td><td>3:1</td><td>3</td><td>1</td></tr>\n",
       "\t<tr><td>Sun May 30, 2010</td><td>2:15 PM</td><td>England</td><td>Japan  </td><td>4-4-2 double 6 </td><td>Fabio Capello</td><td>15.326</td><td>2:1</td><td>2</td><td>1</td></tr>\n",
       "\t<tr><td>Wed Aug 11, 2010</td><td>9:00 PM</td><td>England</td><td>Hungary</td><td>4-2-3-1        </td><td>Fabio Capello</td><td>72.024</td><td>2:1</td><td>2</td><td>1</td></tr>\n",
       "\t<tr><td>Wed Nov 17, 2010</td><td>9:00 PM</td><td>England</td><td>France </td><td>4-2-3-1        </td><td>Fabio Capello</td><td>85.495</td><td>1:2</td><td>1</td><td>2</td></tr>\n",
       "\t<tr><td>Wed Feb 9, 2011 </td><td>8:15 PM</td><td>Denmark</td><td>England</td><td>4-2-3-1        </td><td>Fabio Capello</td><td>21.523</td><td>1:2</td><td>1</td><td>2</td></tr>\n",
       "\t<tr><td>Tue Mar 29, 2011</td><td>9:00 PM</td><td>England</td><td>Ghana  </td><td>4-1-4-1        </td><td>Fabio Capello</td><td>80.102</td><td>1:1</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>Sat Nov 12, 2011</td><td>6:15 PM</td><td>England</td><td>Spain  </td><td>4-3-3 Attacking</td><td>Fabio Capello</td><td>87.189</td><td>1:0</td><td>1</td><td>0</td></tr>\n",
       "\t<tr><td>Tue Nov 15, 2011</td><td>9:00 PM</td><td>England</td><td>Sweden </td><td>4-5-1 flat     </td><td>Fabio Capello</td><td>48.876</td><td>1:0</td><td>1</td><td>0</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A data.frame: 9 × 10\n",
       "\\begin{tabular}{llllllllll}\n",
       " Date & Time & Home team & Away team & System of play & Coach & Attendance & Result & goals\\_scored\\_links & goals\\_scored\\_rechts\\\\\n",
       " <chr> & <chr> & <chr> & <chr> & <chr> & <chr> & <chr> & <chr> & <chr> & <chr>\\\\\n",
       "\\hline\n",
       "\t Wed Mar 3, 2010  & 9:00 PM & England & Egypt   & 4-4-2 double 6  & Fabio Capello & 80.602 & 3:1 & 3 & 1\\\\\n",
       "\t Mon May 24, 2010 & 9:00 PM & England & Mexico  & 4-2-3-1         & Fabio Capello & 88.638 & 3:1 & 3 & 1\\\\\n",
       "\t Sun May 30, 2010 & 2:15 PM & England & Japan   & 4-4-2 double 6  & Fabio Capello & 15.326 & 2:1 & 2 & 1\\\\\n",
       "\t Wed Aug 11, 2010 & 9:00 PM & England & Hungary & 4-2-3-1         & Fabio Capello & 72.024 & 2:1 & 2 & 1\\\\\n",
       "\t Wed Nov 17, 2010 & 9:00 PM & England & France  & 4-2-3-1         & Fabio Capello & 85.495 & 1:2 & 1 & 2\\\\\n",
       "\t Wed Feb 9, 2011  & 8:15 PM & Denmark & England & 4-2-3-1         & Fabio Capello & 21.523 & 1:2 & 1 & 2\\\\\n",
       "\t Tue Mar 29, 2011 & 9:00 PM & England & Ghana   & 4-1-4-1         & Fabio Capello & 80.102 & 1:1 & 1 & 1\\\\\n",
       "\t Sat Nov 12, 2011 & 6:15 PM & England & Spain   & 4-3-3 Attacking & Fabio Capello & 87.189 & 1:0 & 1 & 0\\\\\n",
       "\t Tue Nov 15, 2011 & 9:00 PM & England & Sweden  & 4-5-1 flat      & Fabio Capello & 48.876 & 1:0 & 1 & 0\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A data.frame: 9 × 10\n",
       "\n",
       "| Date &lt;chr&gt; | Time &lt;chr&gt; | Home team &lt;chr&gt; | Away team &lt;chr&gt; | System of play &lt;chr&gt; | Coach &lt;chr&gt; | Attendance &lt;chr&gt; | Result &lt;chr&gt; | goals_scored_links &lt;chr&gt; | goals_scored_rechts &lt;chr&gt; |\n",
       "|---|---|---|---|---|---|---|---|---|---|\n",
       "| Wed Mar 3, 2010  | 9:00 PM | England | Egypt   | 4-4-2 double 6  | Fabio Capello | 80.602 | 3:1 | 3 | 1 |\n",
       "| Mon May 24, 2010 | 9:00 PM | England | Mexico  | 4-2-3-1         | Fabio Capello | 88.638 | 3:1 | 3 | 1 |\n",
       "| Sun May 30, 2010 | 2:15 PM | England | Japan   | 4-4-2 double 6  | Fabio Capello | 15.326 | 2:1 | 2 | 1 |\n",
       "| Wed Aug 11, 2010 | 9:00 PM | England | Hungary | 4-2-3-1         | Fabio Capello | 72.024 | 2:1 | 2 | 1 |\n",
       "| Wed Nov 17, 2010 | 9:00 PM | England | France  | 4-2-3-1         | Fabio Capello | 85.495 | 1:2 | 1 | 2 |\n",
       "| Wed Feb 9, 2011  | 8:15 PM | Denmark | England | 4-2-3-1         | Fabio Capello | 21.523 | 1:2 | 1 | 2 |\n",
       "| Tue Mar 29, 2011 | 9:00 PM | England | Ghana   | 4-1-4-1         | Fabio Capello | 80.102 | 1:1 | 1 | 1 |\n",
       "| Sat Nov 12, 2011 | 6:15 PM | England | Spain   | 4-3-3 Attacking | Fabio Capello | 87.189 | 1:0 | 1 | 0 |\n",
       "| Tue Nov 15, 2011 | 9:00 PM | England | Sweden  | 4-5-1 flat      | Fabio Capello | 48.876 | 1:0 | 1 | 0 |\n",
       "\n"
      ],
      "text/plain": [
       "  Date             Time    Home team Away team System of play  Coach        \n",
       "1 Wed Mar 3, 2010  9:00 PM England   Egypt     4-4-2 double 6  Fabio Capello\n",
       "2 Mon May 24, 2010 9:00 PM England   Mexico    4-2-3-1         Fabio Capello\n",
       "3 Sun May 30, 2010 2:15 PM England   Japan     4-4-2 double 6  Fabio Capello\n",
       "4 Wed Aug 11, 2010 9:00 PM England   Hungary   4-2-3-1         Fabio Capello\n",
       "5 Wed Nov 17, 2010 9:00 PM England   France    4-2-3-1         Fabio Capello\n",
       "6 Wed Feb 9, 2011  8:15 PM Denmark   England   4-2-3-1         Fabio Capello\n",
       "7 Tue Mar 29, 2011 9:00 PM England   Ghana     4-1-4-1         Fabio Capello\n",
       "8 Sat Nov 12, 2011 6:15 PM England   Spain     4-3-3 Attacking Fabio Capello\n",
       "9 Tue Nov 15, 2011 9:00 PM England   Sweden    4-5-1 flat      Fabio Capello\n",
       "  Attendance Result goals_scored_links goals_scored_rechts\n",
       "1 80.602     3:1    3                  1                  \n",
       "2 88.638     3:1    3                  1                  \n",
       "3 15.326     2:1    2                  1                  \n",
       "4 72.024     2:1    2                  1                  \n",
       "5 85.495     1:2    1                  2                  \n",
       "6 21.523     1:2    1                  2                  \n",
       "7 80.102     1:1    1                  1                  \n",
       "8 87.189     1:0    1                  0                  \n",
       "9 48.876     1:0    1                  0                  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_football %>% select('Result') -> test\n",
    "\n",
    "df_test = c()\n",
    "df_test2 = c()\n",
    "\n",
    "for (item in test$Result) {\n",
    "    \n",
    "    df_test = c(df_test, c(strsplit(item, ':')[[1]][1]))\n",
    "    df_test2 = c(df_test2, c(strsplit(item, ':')[[1]][2]))\n",
    "}\n",
    "\n",
    "df_test\n",
    "\n",
    "df_football$goals_scored_links = df_test\n",
    "df_football$goals_scored_rechts = df_test2\n",
    "\n",
    "df_football\n",
    "\n",
    "#mutate(test, goals = strsplit(Result, ':')[[1]][2]) -> new_df\n",
    "\n",
    "#new_df"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "R",
   "language": "R",
   "name": "ir"
  },
  "language_info": {
   "codemirror_mode": "r",
   "file_extension": ".r",
   "mimetype": "text/x-r-source",
   "name": "R",
   "pygments_lexer": "r",
   "version": "4.0.5"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 95.460805,
   "end_time": "2022-08-10T13:59:23.356255",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2022-08-10T13:57:47.895450",
   "version": "2.3.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
